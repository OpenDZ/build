[kay@ank build]$ sudo ./install-fedora.sh 
Fedora rawhide - x86_64                                                                                               5.4 MB/s |  44 MB     00:08    
[...]
Creating 4.0 filesystem on system.img, block size 131072.

[kay@ank build]$ ls -lh system.img 
-rw-r--r-- 1 root root 92M Nov 23 22:47 system.img

[kay@ank build]$ sudo ./test-init.sh 
+ set -e
+ test -z ''
+ exec unshare -m ./test-init.sh init
+ set -e
+ test -z init
+ mkdir -p sysroot
+ mount -t tmpfs tmpfs sysroot
+ mkdir -p sysroot/usr
+ mount -tsquashfs system.img sysroot/usr
+ mount -o remount,ro,bind sysroot/usr sysroot/usr
+ ln -s usr/bin sysroot/bin
+ ln -s usr/etc sysroot/etc
+ mkdir -p sysroot/lib64
+ ln -s ../usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2 sysroot/lib64/ld-linux-x86-64.so.2
+ mkdir -p Data/var sysroot/var
+ mount --bind Data/var sysroot/var
+ mkdir -p sysroot/proc sysroot/sys sysroot/dev
+ mount -t proc proc sysroot/proc
+ mount -t sysfs sysfs sysroot/sys
+ mount -t devtmpfs devtmpfs sysroot/dev
+ exec chroot sysroot bash
bash-4.3# 
bash-4.3# mount
tmpfs on / type tmpfs (rw,relatime)
/home/kay/src/bus1/build/system.img on /usr type squashfs (ro,relatime)
/dev/sda5 on /var type btrfs (rw,relatime,ssd,space_cache,subvolid=5,subvol=/kay/src/bus1/build/Data/var)
proc on /proc type proc (rw,relatime)
sysfs on /sys type sysfs (rw,relatime)
devtmpfs on /dev type devtmpfs (rw,relatime,size=4020392k,nr_inodes=1005098,mode=755)
bash-4.3# 

[kay@ank build]$ sudo ./build-initrd.sh t
/tmp/initrd-tmp0EA
├── bin -> usr/bin
├── etc
│   ├── ld.so.cache
│   ├── ld.so.conf
│   └── ld.so.conf.d
│       └── x86_64-linux-gnu.conf
[...]
31 directories, 65 files

[kay@ank build]$ ls -lh initrd 
-rw-r--r-- 1 root root 3.1M Nov 23 22:51 initrd
